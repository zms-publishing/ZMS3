<!DOCTYPE html>
<html lang="en">
<tal:block tal:content="structure python:here.zmi_html_head(here,request)">zmi_html_head</tal:block>
<body tal:attributes="class python:' '.join(['zmi',request['lang'],'preview_top',here.meta_id])">
<tal:block tal:content="structure python:'<script>'"></tal:block>
	function compile_lesscss() {
		$.get("compile_lesscss",function(result){
				confirm(result);
				self.parent.partner.location.reload();
			});
	}
	function open_partner(sender,preview) {
		$(".zmi-top-active").removeClass("zmi-top-active");
		$(sender).addClass("zmi-top-active");
		var url = self.parent.partner.location.href;
		<tal:block tal:condition="python:len(here.getConfProperty('ASP.ip_or_domain',''))>0">
		if (!preview) {
			var protocol = url;
			protocol = protocol.substr(0,protocol.indexOf(":")+3);
			var server_url = url;
			server_url = server_url.substr(protocol.length);
			server_url = protocol + server_url.substr(0,server_url.indexOf("/"));
			url = '<tal:block tal:content="python:here.getConfProperty('ASP.ip_or_domain')"></tal:block>'+url.substr(server_url.length);
		}
		</tal:block>
		if (url.indexOf("?") > 0) {
			url = url.substr(0,url.indexOf("?"));
		}
		if (preview) {
			url += "?preview=preview";
		}
		self.parent.partner.location.href = url;
	}
<tal:block tal:content="structure python:'</script>'"></tal:block>
<div id="zmi-header">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<tal:block tal:content="structure python:here.zmi_navbar_brand(here,request)">zmi_navbar_brand</tal:block>
		<div class="pull-right">
			&nbsp;|&nbsp;<a tal:attributes="href python:'manage_main?lang=%s'%request['lang']" target="_parent">
				<tal:block tal:content="python:'%s %s %s'%(here.getZMILangStr('BACK'),here.getZMILangStr('TO'),here.display_type(request))">back to display_type</tal:block>
				<tal:block tal:condition="python:here.display_type(request)!=here.getTitlealt(request)" tal:content="structure python:': %s'%here.string_maxlen(here.getTitlealt(request).replace(' & ',' &amp; '),25)">: titlealt</tal:block>
			</a>
			&nbsp;|&nbsp;<span class="ui-helper-clickable zmi-top-active" onclick="open_partner(this,true);">
				<tal:block tal:content="python:here.getZMILangStr('TAB_PREVIEW')">preview</tal:block>
			</span>
			<tal:block tal:condition="python:len(here.getConfProperty('ASP.ip_or_domain',''))>0 or not here.getAutocommit()">
				&nbsp;|&nbsp;<span class="ui-helper-clickable" onclick="open_partner(this,false);">
				<tal:block tal:content="python:here.getZMILangStr('TAB_LIVE')">live</tal:block>
			</span>
			</tal:block>
			<tal:block tal:condition="python:len(here.getConfProperty('InstalledProducts.lesscss',''))>0">
				&nbsp;|&nbsp;<span class="btn btn-primary" title="Compile lesscss!" onclick="compile_lesscss(this,false);">
				<tal:block tal:content="structure python:here.zmi_icon(name='icon-cogs')"></tal:block> {lessc}
			</span>
			</tal:block>
		</div><!-- .pull-right -->
	</div><!-- .navbar -->
</div><!-- #zmi-header -->
<tal:block tal:content="structure python:here.zmi_html_foot(here,request)">zmi_html_foot</tal:block>
</body>
</html>
