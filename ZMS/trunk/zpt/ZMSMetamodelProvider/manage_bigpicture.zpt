<!DOCTYPE html>
<html lang="en">
<tal:block tal:content="structure python:here.zmi_html_head(here,request)">zmi_html_head</tal:block>
<body tal:attributes="class python:' '.join(['zmi',request['lang'],'analyze',here.meta_id])">
<form class="form-horizontal">

<style>
.box {
	background-color:#CFC;
	border:1px solid #00C;
	border-radius:4px;
	padding:0;
	margin:1em 1em 2em 1em;
	text-align:left;
	width:30em;
	position:relative;
	cursor:auto;
}
.box div {
	padding:.15em .5em
}
.box .id {
	border-bottom:1px solid #00C;
	text-align:center;
	
}
.box .type {
	text-align:center;
	font-style:italic;
	color:darkgreen;
}
.box .attr {
	font-size:smaller;
}
.attrId {
	font-weight:bold
}
.attrType {
	color:darkgreen;
	float:right;
}
.box .attr.subobject {
	background-color:#DFD;
}
.box .ref {
	padding:2px;
	position:absolute;
	left:30em;
	margin-top:-2.5em;
}
.box .ref .cardinality {
	border-bottom:1px solid #C00;
	padding:2px;
	min-width:10em;
	font-size:smaller;
}
.box .ref .attr {
	background-color:#FFE;
	border:1px solid #C00;
	border-radius:4px;
	padding:2px;
	min-width:10em;
	font-size:smaller;
	margin-top:0.8em
}
</style>

<tal:block tal:define="global
		packageId request/id;
		metaObjIds python:here.getMetaobjIds();
		metaObjs python:map(lambda x: here.getMetaobj(x), metaObjIds)">

	<legend tal:content="python:'BigPicture::LogicalView::%s'%packageId">the legend</legend>
	<tal:block tal:repeat="metaObj python:filter(lambda x:x['package']==packageId,metaObjs)">
		<div class="box">
			<div class="type" tal:content="metaObj/type">the type</div>
			<div class="id">
				<tal:block tal:content="structure python:here.display_icon(request,metaObj['id'],zpt=True)">the icon</tal:block>
				<tal:block tal:content="metaObj/id">the id</tal:block>
			</div>
			<tal:block tal:repeat="metaObjAttrId python:here.getMetaobjAttrIds(metaObj['id'])">
				<tal:block tal:define="global metaObjAttr python:here.getMetaobjAttr(metaObj['id'],metaObjAttrId)">
					<div tal:attributes="class python:' '.join(['attr']+[[],['subobject']][int(metaObjAttr['type'] in ['*']+metaObjIds)])" tal:condition="python:metaObjAttr['type'] not in ['delimiter','interface']">
						<span class="attrType" tal:content="metaObjAttr/type">the type</span>
						<span class="attrId" tal:content="metaObjAttr/id">the id</span>:
						<span class="attrName">(<tal:block tal:content="metaObjAttr/name">the name</tal:block>)</span>
					</div><!-- .attr -->
					<div class="ref" tal:condition="python:metaObjAttr['type'] in ['*']+metaObjIds">
						<table cellspacing="0" cellpadding="0" border="0">
						<tr valign="top">
						<td>
							<div class="cardinality">
								<tal:block tal:condition="python:metaObjAttr.get('mandatory',False)">1</tal:block>
								<tal:block tal:condition="python:metaObjAttr.get('repetitive',False)">0..*</tal:block>
								<tal:block tal:condition="python:not metaObjAttr.get('mandatory',False) and not metaObjAttr.get('repetitive',False)">0..1</tal:block>
							</div>
							&nbsp;
						</td>
						<td>
							<div class="attr" tal:condition="python:metaObjAttr['type'] in ['*']" tal:content="structure python:'<br/>'.join(map(lambda x:here.display_type(request,x),metaObjAttr['keys']))"></div>
							<div class="attr" tal:condition="python:metaObjAttr['type'] in metaObjIds" tal:content="python:metaObjAttr['type']"></div>
						</td>
						</tr>
						</table>
					</div><!-- .ref -->
				</tal:block>
			</tal:block>
		</div>
	</tal:block>

</tal:block>

</form>
</body>
</html>
