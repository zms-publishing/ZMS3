<?xml version="1.0" encoding="utf-8"?>

<list>
  <item type="dictionary">
    <dictionary>
      <item key="key"><![CDATA[ZMS]]></item>
      <item key="value" type="dictionary">
        <dictionary>
          <item key="__obj_attrs__" type="list">
            <list>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[## Script (Python) "ZMS.icon"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=zmscontext
##title=py: Icon
##
# --// BO icon //--

try:
  if zmscontext.getLevel()==0:
    key = 'icon_home'
  else:
    key = 'icon_document'
  return getattr(zmscontext.metaobj_manager,'ZMS.%s'%key)
except:
  return None

# --// EO icon //--
]]>
                  </item>
                  <item key="id"><![CDATA[icon]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon]]></item>
                  <item key="py"><![CDATA[<PythonScript at ZMS.icon>]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[py]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[## Script (Python) "ZMS.icon_disabled"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=zmscontext
##title=py: Icon (Disabled)
##
# --// BO icon_disabled //--

try:
  if zmscontext.getLevel()==0:
    key = 'icon_home'
  else:
    key = 'icon_document'
  return getattr(zmscontext.metaobj_manager,'ZMS.%s_disabled'%key)
except:
  return None

# --// EO icon_disabled //--
]]>
                  </item>
                  <item key="id"><![CDATA[icon_disabled]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon (Disabled)]]></item>
                  <item key="py"><![CDATA[<PythonScript at ZMS.icon_disabled>]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[py]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/gif" filename="zms.gif" type="file">47494638396110001000b300008b5826dca7277484b0eec93ad4cbb9f7dc55d4b274ececdcfc02fc666d99e6bc3d8499c4e6f7fc7079a2f3cf47dfb12c21f90401000008002c000000001000100003046010c98908a19812a56ed64e5138deb78962672a28aa6a4ae8c4f25b3d4eae1c07ed3c17c263e0183c0e0cc6615804120203450099544207818b2130ad560f5cc384b0a80200d54449524e9ed39936e39d4cc4cde87a5cc06f341280761f831311003b</data>
                  </item>
                  <item key="id"><![CDATA[icon_home]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon: Home]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/gif" filename="zms_disabled.gif" type="file">47494638396110001000b30000fc02fc848684c4c6c4acaaaceceaec646264b4b6b4d4d6d47c7a7c9496946c6e6cb4b2b4f4f2f4cccaccbcbabc00000021f90401000000002c000000001000100003045f10c8095aa39836e76ed6c271589fb48962f79d68ea4d5b333a821cc34bdd1804d1d58b4b6350130c080c068128305a8886a332b96c0e2e8b8134c95d0e16b004b750e02a5e1271928c6428326a02d90c1f97936f4c22c04720148079258311003b</data>
                  </item>
                  <item key="id"><![CDATA[icon_home_disabled]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon: Home (Disabled)]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/gif" filename="zmsdocument.gif" type="file">47494638396110001000b30000fc02fc8787aeb7c7e4d6ebfcb5d8faa0a6c4c6e1fbf7fbfcb8dffc547ab484baec8f98b9afb9d17496d4acd0fc7573a521f90401000000002c00000000100010000304691008c158592bbc02ba6747281e8db0781d3886cda024a8bab606f378c53a904d7f77391d6128f80116bac36060301891a2e5d2c03406a24aa981605566a74daee7faa51a100871e7aa1da0d36a40403a4513100ee343d97c0f1d791e0f744c6f697a0f898a8b891d11003b</data>
                  </item>
                  <item key="id"><![CDATA[icon_document]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon: Document]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/gif" filename="zmsdocument_disabled.gif" type="file">47494638396110001000b30000fc02fc8c8a8cc4c6c4e4e6e4a4a6a4d4d2d47476749c9a9cbcbabcfcfafc949294acaeacdcdadccccacc7c7a7cd4d6d421f90401000000002c000000001000100003046e1008b110512a3802ba47492826817078dd220ea2322c060a8ea1fb207147d02c86399e1daf4014003b0a5e623060308e80c388c964347380c06a496514a05a16b5e92c60b5dc66f3f1f87ac2d501bb6d7e8fd7ed4703ea583a1f0c740d461e0e7781736e1d0e0e068c8e8d8f4711003b</data>
                  </item>
                  <item key="id"><![CDATA[icon_document_disabled]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon: Document (Disabled)]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/png" filename="zms2go.png" type="file">89504e470d0a1a0a0000000d4948445200000050000000210802000000c10dbb9e0000000674524e5300ff00ff00ff37581b7d00000009704859730000176000001760013c7c65ec000008dd49444154789ced596b4c94d9197ebffb7c73036440145dc011ab5299517477a3acd5880622d11a63cca8b409c6a281c4d4c58dc6303166bdd0345917a331c6d618572d5a62bd34ab484a68228a069021e83a0195416690ebcc3097ef7efae36bc79901dbf48734b13e991fe77bdff79cf779ce9cf39ef3cd600821f87f02febf2630d5f824f863c727c11f3bc829cb8410922449108460308810a2695aa3d1d0344d10c494718029132c8a627b7bfbfdfbf75fbc7871edda359ee7172d5ab462c58a952b57ae59b326252505c3b0a96102e8c383e7f9baba3aabd53a317b727272454585cbe59a021a2aa64270535393c562494848282d2dbd72e5cac3870f5b5a5aeedfbf5f5555451004cbb29595958aa24c0113340582c7c6c64a4b4b01e0e8d1a3a15028da258ae2c58b174d26934ea76b6d6dfdd04c547c70c10e87233b3b1b00dc6ef744afcfe7b3d96c2449daedf60fcd44c5072f5ae9e9e935353500909a9a3ad16b301812131325496a6b6bfbd04c54c4089695615976c74510c44c451943281c792470130048b24b51bc0080610c45fe0c0010126465505146017092988de37a0062dab469858585ef4b2f0802cff314457df5d557712e51140381c0e0e020c7712ccb262727ebf57a8661260e82100a854263636323232300307dfa74a3d1c8b2eca4953f467020f4a7e1b1dfc64598924e8e072ef06287fa68d4ed31257d8761c4dbe1ed9cf008002832fbb319cf100af902e782e1bf70fc030ca3f4da5fe9d95fb29a351846bd4f2d000c0c0cf4f5f5d1345d5050106defefefbf74e9d2f3e7cf1b1a1adc6ef7ac59b3f2f3f3ad56eb8e1d3bd2d3d3a323398e6b6c6c6c686878f4e85173733300141616e6e6e6ae5fbf7ef9f2e52419bf84ffeb25cd8b4f14c50718f0a22326b1d0eaf5ff4e5686000021713cf80759eea7e9452491fe9e914010841b376e3c7efcb8a8a868e1c28511fbb367cfbefdf65b8fc7b37af5ead5ab57d334cdf3fcebd7af6fdfbeed743aed767b4646861a89103a7bf6ecf7df7f6fb158b66fdf5e5e5eae4ee29d3b776eddba65b7db6d365b7cd6e80d2d2b7e51ea15a55e8e6feb7fbbb6db45f6ba73c25c739f27afdb45aa1f972797177ee2f8f69e3ebd6ae9752f40080d8e9677bbe86e1739e2adea75e774bbc89e3e6d987ff4bee22149d28d1b370c06c3e2c58b5b5a5a22f681818192929292929257af5e711ca71e57b22c731cd7d6d6969f9f5f5d5dcdf33c42485194bb77ef5aadd6cb972f0f0d0d4992a48e200882dbed3e72e4c882050b1e3c781077e0c5dca571cc40129f91c46c591912a51e0082a197d1d4cfa363647958103b435c03202976e2c2000a00e0b841c7aed76bb7ead84d049ef4beeff6d6ad5b3b77eed4ebf55f7ffdf592254b22ae868686c6c6c6d2d2d2cccc4c8661d47d88e338c330b9b9b9fbf6ed33180c922401c0e8e8e8a143874a4b4bb76cd96232992257548aa266cc9851595999959575e2c409bfdf1fa371221b84b830df24c92e1cd3eab59b70dc1071d1d42259190cf37f0f713f52d482e85e1afa0b1cd303c078b056cb164d4ffe617af20f14396fe2f89224ddb97367dfbe7da2281e3f7e7cf3e6cd919d8610eae8e858b76edde2c58b2776240862c3860dbb76edd26ab500f0f2e5cbf1f1f1c2c2428a9aa44cb02cbb77efdec1c141b73ba60c4f225851bc61ae090070dca861628aa786fe120004a14d965d6a3b022d5b4c106900b820760c8d9685c2f700e48983cbb27ce5ca958a8a0a8fc773f2e4499bcda6d168a2522b172e5c484b4b33180cd1c6e0bfc0711ccff38aa200407d7dfd9b376fb2b2b2266651919d9ded70389e3c79f21f0487b8065e68018004c3feb83549d35600e08416517aadb623208999334c7fd56b6d386e14a5974363bf0984ea10bc5bf608a19191913367ce54545498cde69b376f969494d0341d977d78789820081c7f47cce974ea63d1d5d505007ebf5f10848975f81d25920c87c3c16030c61817a4a0903ff0470020f03496c98ff312b889a12cbcd841538b083cfe22415159c989c7a860b66ffc3b497607427f66995f10c474d5dbdbdb5b535373e9d2a5152b561c3c7870d23303c3308bc5c2719c244911afc9643a72e488daeeececbc7efdbada9e33678ed168e4382e7a8d4423180ca6a6a6ce9c39f3df091625a720750100cbaea5c849560b437fc18b1d0c9d876131efb15effef435c3d001874bf26897441f185f946497ea30af6783cdbb66d73381c454545478f1e9d3b776ef477182db8b8b8d8e572f9fdfe69d3a64504575555a9edab57af46047ffef9e7a9a9a92f5ebcb0582c930a763a9d73e7ce8d3ef0206e492310bdbee38a3286e37a2db306c7f5134721c94c0020898cb8bea2dc1be69bc27ca382c6d47954142f423c00bc7dfb76ebd6ad4f9f3e2d2b2b3b77eedcbc79f32655ab0a2e2828e8eaea6a6a6a124531ce8b10e2793ef2b870e1c29c9c9c9a9a1af5ed323a525194eeeeeef3e7cfe7e5e5656666c6f08f212d768b722f0010788a283df78d9f02009659f58e10aec5f14400c0f1041cd745f765e9e501fcaaa2f842dcdf646510004862368e1b0441b87efd7a6767a7d168341a8d172f5e9c546a5656d6c68d1b0160d9b2655bb66c3975ea545f5fdfa64d9bd2d2d2288a9224c9e7f3b5b6b6d6d6d6ce9f3f5fafd70300c330274e9cb0d96cfbf7ef2f2f2fcfcbcbd3e97400e0f57a1f3e7c78faf4694992bef9e69bb81a1e2398179e88e24f00204aafc6fcd5aad194743212406006842700008127e09831ba2fc37c89637a057ca1f0ed7f4e81a68024660f0c0cdfbb77cfebf502c0e1c38727550b00c5c5c5aa609d4eb773e74ead566bb7dbebeaea9292924892946539180cf6f7f72f5dbab4b2b23272bb349bcdd5d5d5870f1f2e2b2b339bcdea660e04024ea7332727e7d8b163b366cd8a4b14b7873182488bfb8909c7124872b682020080611a8acca04833456660988622cd0040929f01004566cc48f93118be19e2ee2aca6892d1ae61f2713cc1e3e9e9e9e9319bcdef93aa222d2d2dd24e4949d9b367cfdab56b1d0e477373737d7d7d7a7afac68d1b972c5962b55a59968dec080cc356ad5a555757d7dededed4d4545b5b0b00bb77ef3e70e080c562494c4c9c9808439ffe6af9b8f149f0c78e4f823f76fc0312e467833a1335f70000000049454e44ae426082</data>
                  </item>
                  <item key="id"><![CDATA[zms2go.png]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[zms2go.png]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[interface0]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[<dtml-let meta_id="REQUEST.get('ZMS_INSERT',meta_id)"
		objAttr="getObjAttr('text',meta_id)"
		session_id="SESSION.getId()"
>

<style>
span.zms2goButton img {
	background:url(metaobj_manager/<dtml-var meta_id>.zms2go.png) no-repeat top right;
	width:80px;
	height:33px;
}
span.active {
	background-color:#FFF;
	font-weight:bold;
}
span.mouseover {
	border:1px solid #999;
	background-color:#DFF1FF;
}
</style>

<dtml-comment>
////////////////////////////////////////////////////////////////////////////////
/// ZMS2GO Headline
////////////////////////////////////////////////////////////////////////////////
</dtml-comment>

<div id="interface0">
<input type="hidden" id="titlealt_<dtml-var lang>" name="titlealt_<dtml-var lang>" value=""/>
<input type="hidden" id="title_<dtml-var lang>" name="title_<dtml-var lang>" value=""/>
<input type="hidden" id="text_<dtml-var lang>" name="text_<dtml-var lang>" value=""/>
<div style="width:100%;text-align:right">
	<span class="zms2goButton">
		<img src="<dtml-var spacer_gif>" alt="" border="0"/>
	</span>
</div>

<dtml-comment>
////////////////////////////////////////////////////////////////////////////////
/// CKEDITOR Plugin
////////////////////////////////////////////////////////////////////////////////
</dtml-comment>

<dtml-call "REQUEST.set('elName','editor')">
<dtml-call "REQUEST.set('CKEDITOR_config_toolbar',[
		['Format'],
		['Bold','Italic','Underline','NumberedList','BulletedList'],
		['Undo','Redo'],
		['mediabutton'],
		['Find','linkbutton','Link','Unlink'],
		['Anchor','Table'],
		['Source','ShowBlocks','Maximize','About']
	])">
<dtml-call "REQUEST.set('CKEDITOR_config_contentsCss',['metaobj_manager/ZMS.contents.css'])">
<dtml-call "REQUEST.set('f_zmiRichtextOnSubmitEventHandler',True)">
<dtml-var "getPlugin('rte/ckeditor/manage_form.dtml',REQUEST)">

<script>

////////////////////////////////////////////////////////////////////////////////
/// Richedit
////////////////////////////////////////////////////////////////////////////////

function extractString(s, start, end) {
	var i = s.toLowerCase().indexOf(start.toLowerCase());
	if (i < 0) {
		return '';
	}
	s = s.substr(i+start.length);
	s = s.substr(0,s.toLowerCase().indexOf(end.toLowerCase())).basicTrim();
	start = '<span class="skip">';
	end = '</span>';
	i = s.toLowerCase().indexOf(start.toLowerCase());
	if (i >= 0) {
		s = s.substr(s.toLowerCase().indexOf(end.toLowerCase())+end.length).basicTrim();
	}
	return s;
}

$(function() {
	if($("form#form0 input[name=session_id]").length==0) {
		$("form#form0").append('<input type="hidden" name="session_id" value="<dtml-var session_id>"/>');
	}
	$("input#submitBtn0").click(function() {
			var instance = CKEDITOR.instances['editor_<dtml-var elName>'];
			var body = instance.getData();
			var subtitle = extractString(body,'<h2 id="subtitle">','</h2>');
			if (subtitle.length == 0) {
				alert("Missing subtitle!");
				return false;
			}
			body = body.substr(body.toLowerCase().indexOf('</h2>')+'</h2>'.length).basicTrim();
			var title = extractString(body,'<h1 id="title">','</h1>');
			if (title.length == 0) {
				alert("Missing title!");
				return false;
			}
			body = body.substr(body.toLowerCase().indexOf('</h1>')+'</h1>'.length);
			$("input#titlealt_<dtml-var lang>").val(subtitle);
			$("input#title_<dtml-var lang>").val(title);
			$("input#text_<dtml-var lang>").val(body);
		});
});

</script>

<textarea id="<dtml-var "REQUEST.get('elName')">" name="<dtml-var "REQUEST.get('elName')">" class="ui-helper-hidden">
<dtml-if ZMS_INSERT>
<h2 id="subtitle"><span class="skip"><dtml-var "getZMILangStr('ATTR_TITLEALT')"></span>&laquo; <dtml-var "getZMILangStr('ATTR_TITLEALT')"> &raquo;</h2>
<h1 id="title"><span class="skip"><dtml-var "getZMILangStr('ATTR_TITLE')"></span>&laquo; <dtml-var "getZMILangStr('ATTR_TITLE')"> &raquo;</h1>
<p>&laquo; <dtml-var "getZMILangStr('ATTR_TEXT')"> &raquo;</p>
<dtml-else>
<h2 id="subtitle"><span class="skip"><dtml-var "getZMILangStr('ATTR_TITLEALT')"></span><dtml-var "attr('titlealt')"></h2>
<h1 id="title"><span class="skip"><dtml-var "getZMILangStr('ATTR_TITLE')"></span><dtml-var "attr('title')"></h1>
<dtml-var "attr('text')">
</dtml-if>
</textarea>

<dtml-var f_submitBtn>

</dtml-let>

<dtml-call "REQUEST.set('ZMS_HIDE_ELEMENTS',REQUEST.get('ZMS_HIDE_ELEMENTS',[])+['titlealt','title','text'])">]]>
                  </item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[interface]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[titlealt]]></item>
                  <item key="mandatory" type="int">1</item>
                  <item key="multilang" type="int">1</item>
                  <item key="name"><![CDATA[DC.Title.Alt]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[titlealt]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[title]]></item>
                  <item key="mandatory" type="int">1</item>
                  <item key="multilang" type="int">1</item>
                  <item key="name"><![CDATA[DC.Title]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[title]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[text]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">1</item>
                  <item key="name"><![CDATA[Text]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[richtext]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[e]]></item>
                  <item key="keys" type="list">
                    <list>
                      <item><![CDATA[ZMS]]></item>
                    </list>
                  </item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Objects]]></item>
                  <item key="repetitive" type="int">1</item>
                  <item key="type"><![CDATA[*]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[_e]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Objects]]></item>
                  <item key="repetitive" type="int">1</item>
                  <item key="type"><![CDATA[*]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[span.skip {
	font-size:9px!important;
	color:#666;
	padding:4px;
}
h1#title {
	font-size:24px!important;
	line-height:1em!important;
	padding:4px;
}
h2#subtitle {
	font-size:12x!important;
	line-height:1em!important;
	padding:4px;
}
h1#title, h2#subtitle, div#titleimage {
	border:1px solid #999;
	background-color:#DFF1FF;
}]]>
                  </item>
                  <item key="id"><![CDATA[contents.css]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[CSS (CKEDITOR.config.contentsCss)]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[method]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[## Script (Python) "ZMS.onChangeObjEvt"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=zmscontext=None
##title=py: Event: onChange-Object
##
# --// BO onChangeObjEvt //--

temp_folder = context.temp_folder
request = context.REQUEST

# Find images/files.
text = zmscontext.attr('text')
l = []
lt = []
for sp in ['src="', 'href="' ]:
  for s in text.split(sp):
    ref = s[:s.find('"')]
    if ref.find('/'+zmscontext.id+'/') >= 0:
      idmedia = ref.split('/')[-1]
      l.append(idmedia)
    elif ref.find('/'+temp_folder.id+'/') >= 0:
      lt.append(ref)

# Remove unused images/files.
ob_ids = zmscontext.objectIds(['File','Image'])
for ref in l:
  id = ref.split('/')[-1]
  if id in ob_ids:
    ob_ids.remove(id)
if len(ob_ids) > 0:
  zmscontext.manage_delObjects(ids=ob_ids)

# Add new images/files from temp_folder.
for ref in lt:
  id = ref.split('/')[-1]
  ob = getattr(temp_folder,id,None)
  if ob is not None:
    new_id = ob.title_or_id()
    new_title = ''
    new_data = ob.data
    if ob.meta_type == 'Image':
      zmscontext.manage_addImage( id=new_id, title=new_title, file=new_data)
    else:
      zmscontext.manage_addFile( id=new_id, title=new_title, file=new_data)
    temp_folder.manage_delObjects(ids=[id])
    text = text.replace('"'+ref+'"','"./'+zmscontext.id+'/'+new_id+'"')
zmscontext.attr('text',text)

# --// EO onChangeObjEvt //--
]]>
                  </item>
                  <item key="id"><![CDATA[onChangeObjEvt]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Event: onChange-Object]]></item>
                  <item key="py"><![CDATA[<PythonScript at ZMS.onChangeObjEvt>]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[py]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[<!-- bodyContentZMSCustom_ZMS -->

<tal:block tal:define="global 
		zmscontext options/zmscontext"
		tal:content="structure python:zmscontext.attr('text')">
	The page-content
</tal:block>

<!-- /bodyContentZMSCustom_ZMS -->]]>
                  </item>
                  <item key="id"><![CDATA[bodyContentZMSCustom_ZMS]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Template: ZMS]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[zpt]]></item>
                  <item key="zpt"><![CDATA[<ZopePageTemplate at ZMS.bodyContentZMSCustom_ZMS>]]></item>
                </dictionary>
              </item>
            </list>
          </item>
          <item key="access" type="dictionary">
            <dictionary>
              <item key="delete" type="list">
                <list>
                  <item><![CDATA[ZMSAdministrator]]></item>
                  <item><![CDATA[ZMSAuthor]]></item>
                  <item><![CDATA[ZMSEditor]]></item>
                </list>
              </item>
              <item key="delete_custom"></item>
              <item key="insert" type="list">
                <list>
                  <item><![CDATA[ZMSAdministrator]]></item>
                  <item><![CDATA[ZMSAuthor]]></item>
                  <item><![CDATA[ZMSEditor]]></item>
                </list>
              </item>
              <item key="insert_custom"><![CDATA[{$}]]></item>
            </dictionary>
          </item>
          <item key="enabled" type="int">1</item>
          <item key="id"><![CDATA[ZMS]]></item>
          <item key="name"><![CDATA[ZMSRichDocument]]></item>
          <item key="package"><![CDATA[com.zms2go.foundation]]></item>
          <item key="revision"><![CDATA[0.9.2]]></item>
          <item key="type"><![CDATA[ZMSDocument]]></item>
        </dictionary>
      </item>
    </dictionary>
  </item>
  <item type="dictionary">
    <dictionary>
      <item key="key"><![CDATA[ZMSLib]]></item>
      <item key="value" type="dictionary">
        <dictionary>
          <item key="__obj_attrs__" type="list">
            <list>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[<!-- bodyContentZMSLib_page -->

	<tal:block tal:define="global 
		childNodes    python:here.getObjChildren('e',request,here.PAGEELEMENTS)">
		<tal:block tal:condition="childNodes">
			<tal:block tal:content="structure here/bodyContent_PagePre">The page-pre-content</tal:block>
			<tal:block tal:repeat="childNode childNodes">
				<tal:block tal:content="structure python:unicode(childNode.getBodyContent(request),'utf-8')">
					The page-element body-content
				</tal:block>
			</tal:block>
			<tal:block tal:content="structure here/bodyContent_PagePost">The page-post-content</tal:block>
		</tal:block>
	</tal:block>

<!-- /bodyContentZMSLib_page -->]]>
                  </item>
                  <item key="id"><![CDATA[bodyContentZMSLib_page]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Template: Page]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[Page Template]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[## Script (Python) "ZMSLib.uploadMedia"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=zmscontext=None
##title=py: Upload: Media
##
# --// BO uploadMedia //--

result = {}
temp_folder = context.temp_folder
request = context.REQUEST
base_url = request.get('SERVER_URL')
session_id = request.get('session_id')
form_id = request.get('form_id')
file = request.get('file')

def resize_image(context, orig, maxdims):
  pilutil = context.pilutil()
  width = orig.getWidth()
  height = orig.getHeight()
  while width > maxdims or height > maxdims:
    if width > maxdims:
      height = int(height * maxdims / width)
      width = maxdims
    elif height > maxdims:
      width = int(width * maxdims / height)
      height = maxdims
  size = (width,height)
  blob = pilutil.resize( orig, size)
  return blob

def create_blob(container, blob):
  filename = blob.getFilename()
  data = blob.getData()
  id = session_id + '_' + form_id + '_' + filename
  if id in container.objectIds():
    container.manage_delObjects(ids=[id])
  if blob.getContentType().startswith('image'):
    container.manage_addImage( id=id, title=filename, file=data)
  else:
    container.manage_addFile( id=id, title=filename, file=data)
  ob = getattr(container,id)
  d = {}
  d['content_type'] = blob.getContentType()
  d['filename'] = blob.getFilename()
  d['absolute_url'] = ob.absolute_url()[len(base_url):]
  return d

if file and file.filename:
  blobs = {}
  blob = context.FileFromData(file,file.filename)
  content_type = blob.getContentType()
  if content_type.startswith('image'):
    image = context.ImageFromData(file,file.filename)
    maxdims = int(context.getConfProperty('InstalledProducts.pil.thumbnail.max',100))
    if image.getWidth() > maxdims:
      result['imghires'] = create_blob(temp_folder,image)
      result['image'] = create_blob(temp_folder,resize_image(context, image, maxdims))
    else:
      result['image'] = create_blob(temp_folder,image)
  else:
    result['file'] = create_blob(temp_folder,blob)

result['message'] = context.getZMILangStr( 'MSG_UPLOADED')
return context.str_json(result)

# --// EO uploadMedia //--
]]>
                  </item>
                  <item key="id"><![CDATA[uploadMedia]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Upload: Media]]></item>
                  <item key="py"><![CDATA[<PythonScript at ZMSLib.uploadMedia>]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[py]]></item>
                </dictionary>
              </item>
            </list>
          </item>
          <item key="access" type="dictionary">
            <dictionary>
              <item key="delete" type="list">
                <list>
                </list>
              </item>
              <item key="delete_custom"></item>
              <item key="insert" type="list">
                <list>
                </list>
              </item>
              <item key="insert_custom"></item>
            </dictionary>
          </item>
          <item key="enabled" type="int">0</item>
          <item key="id"><![CDATA[ZMSLib]]></item>
          <item key="name"><![CDATA[ZMSLib]]></item>
          <item key="package"><![CDATA[com.zms.foundation]]></item>
          <item key="revision"><![CDATA[1.1.0]]></item>
          <item key="type"><![CDATA[ZMSLibrary]]></item>
        </dictionary>
      </item>
    </dictionary>
  </item>
  <item type="dictionary">
    <dictionary>
      <item key="key"><![CDATA[ZMSTeaserContainer]]></item>
      <item key="value" type="dictionary">
        <dictionary>
          <item key="__obj_attrs__" type="list">
            <list>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/gif" filename="zmsteasercontainer_16x16.gif" type="file">47494638396110001000b30000040284c48e0c848284fcee84fcfebcfc02fcfcd25cfcfe9c4c4e4c6c6e6cfcf274fcfeecfce26cfcfe84fcfed4fcfaac21f90401000005002c0000000010001000030470b084496b2858aecdfbba58e08c23408e5348ac00d102cf1a7cd273dc407edf62200483460eb018361a01422011381e8dcec061091c2800d701c0aa685219608636cce8229960433aac062e259680c13001bf256b867c694f64e2134c010802190502098989540985868f217790907711003b</data>
                  </item>
                  <item key="id"><![CDATA[icon]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/gif" filename="zmsteasercontainer_disabled_16x16.gif" type="file">47494638396110001000b300004c4e4c848284d4d6d4eceaece4e2e4f4f6f4fc02fcdcdedcf4f2f46c6e6c8c8e8cdcdadcfcfafceceeece4e6e40000ff21f90401000006002c000000001000100003046bd0a849ab3258b2cd3bbb98e225de14220c92a86cf17d1252206ab2a688a8040ad2d824204d97500c068801f098ec298a474742493d3a8b87c582b0486cb584ab62cb2d8317c6a7c4a210082684700213d0dadb4fae3ac47e4e000119060140367e0981828a7c738b8e7b11003b</data>
                  </item>
                  <item key="id"><![CDATA[icon_disabled]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon (Disabled)]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[interface]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[<dtml-let
  teaserCntnr="this()"
  bgcolor_border="teaserCntnr.getObjProperty('attr_bgcolor_border',REQUEST)"
  bgcolor_title="teaserCntnr.getObjProperty('attr_bgcolor_title',REQUEST)"
  bgcolor_text="teaserCntnr.getObjProperty('attr_bgcolor_text',REQUEST)"
  element="[]">

<dtml-call "element.append('<div class=\'ZMSTeaserElement\' style=\'width:30px;\'>')">
<dtml-call "element.append('<div align=\'center\' class=\'title\'')">
<dtml-if bgcolor_title><dtml-call "element.append(' style=\'background-color:%s\''%get_colormap().get(bgcolor_title,'transparent'))"></dtml-if>
<dtml-call "element.append('><img src=\'%s\' title=\'%s\' border=\'0\' width=\'24\' height=\'4\'></div>'%(spacer_gif,getZMILangStr('ATTR_TITLE')))">
<dtml-call "element.append('<div align=\'center\' class=\'text\'')">
<dtml-if bgcolor_text><dtml-call "element.append(' style=\'background-color:%s\''%get_colormap().get(bgcolor_text,'transparent'))"></dtml-if>
<dtml-call "element.append('><img src=\'%s\' title=\'%s\' border=\'0\' width=\'24\' height=\'4\'></div>'%(spacer_gif,getZMILangStr('ATTR_TEXT')))">
<dtml-call "element.append('</div>')">
<dtml-let element_icon="''.join(element)">

<dtml-var "f_headline(_,_,headline=getZMILangStr('ATTR_BORDERSTYLE'))">

<table cellspacing="2" cellpadding="1" border="0">
<tr valign="top">

<dtml-comment> ##### Border-Style 1=SOLID ##### </dtml-comment>
   <td>
    <div class="form-element">
     <input class="form-radio" type="radio" name="attr_borderstyle:int" value="1"<dtml-if "getObjProperty('attr_borderstyle',REQUEST)==1"> checked="checked"</dtml-if>/>
     <dtml-var "getZMILangStr('OPT_AB_SOLID')">&nbsp;
    </div>
   </td>
   <td>
    <div id="Teaser" style="width:30px;">
     <div class="ZMSTeaserContainer" style="width:30px;margin-bottom:4px;<dtml-if bgcolor_border>background-color: <dtml-var "get_colormap().get(bgcolor_border,'black')">;</dtml-if>">
      <dtml-var element_icon>
      <dtml-var element_icon>
      <dtml-var element_icon>
     </div>
    </div>
   </td>

<dtml-comment> ##### Border-Style 2=SINGLE ##### </dtml-comment>
   <td>
    <div class="form-element">
     <input class="form-radio" type="radio" name="attr_borderstyle:int" value="2"<dtml-if "getObjProperty('attr_borderstyle',REQUEST)==2"> checked="checked"</dtml-if>/>
     <dtml-var "getZMILangStr('OPT_AB_SINGLE')">&nbsp;
    </div>
   </td>
   <td>
    <div id="Teaser" style="width:30px;">
     <div class="ZMSTeaserContainer" style="width:30px;margin-bottom:4px;<dtml-if bgcolor_border>background-color: <dtml-var "get_colormap().get(bgcolor_border,'black')">;</dtml-if>">
      <dtml-var element_icon>
     </div>
     <div class="ZMSTeaserContainer" style="width:30px;margin-bottom:4px;<dtml-if bgcolor_border>background-color: <dtml-var "get_colormap().get(bgcolor_border,'black')">;</dtml-if>">
      <dtml-var element_icon>
     </div>
     <div class="ZMSTeaserContainer" style="width:30px;margin-bottom:4px;<dtml-if bgcolor_border>background-color: <dtml-var "get_colormap().get(bgcolor_border,'black')">;</dtml-if>">
      <dtml-var element_icon>
     </div>
    </div>
   </td>

<dtml-comment> ##### Border-Style 3=NONE ##### </dtml-comment>
   <td>
    <div class="form-element">
     <input class="form-radio" type="radio" name="attr_borderstyle:int" value="3"<dtml-if "getObjProperty('attr_borderstyle',REQUEST)==3"> checked="checked"</dtml-if>/>
     <dtml-var "getZMILangStr('OPT_AB_NONE')">&nbsp;
    </div>
   </td>
   <td>
    <div id="Teaser" style="width:30px;">
     <dtml-var element_icon>
     <dtml-var element_icon>
     <dtml-var element_icon>
    </div>
   </td>

</tr>
</table>

<dtml-call "REQUEST.set('ZMS_HIDE_ELEMENTS',REQUEST.get('ZMS_HIDE_ELEMENTS',[])+['attr_borderstyle'])">

<dtml-var "f_headline(_,_,headline=getZMILangStr('ATTR_BGCOLORS'))">

</dtml-let>
</dtml-let>]]>
                  </item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[interface]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="default"><![CDATA[1]]></item>
                  <item key="id"><![CDATA[attr_borderstyle]]></item>
                  <item key="mandatory" type="int">1</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Border-Style]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[int]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="default"><![CDATA[primColorStrong0]]></item>
                  <item key="id"><![CDATA[attr_bgcolor_border]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Background-Color (Border)]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[color]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="default"><![CDATA[primColorLight0]]></item>
                  <item key="id"><![CDATA[attr_bgcolor_title]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Background-Color (Title)]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[color]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="default"><![CDATA[neutralColorWhite]]></item>
                  <item key="id"><![CDATA[attr_bgcolor_text]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Background-Color (Text)]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[color]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[e]]></item>
                  <item key="keys" type="list">
                    <list>
                      <item><![CDATA[ZMSNote]]></item>
                      <item><![CDATA[ZMSFile]]></item>
                      <item><![CDATA[ZMSLinkElement]]></item>
                      <item><![CDATA[type(ZMSTeaserElement)]]></item>
                    </list>
                  </item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Teaser-Elements]]></item>
                  <item key="repetitive" type="int">1</item>
                  <item key="type"><![CDATA[*]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[## Script (Python) "getTeaserElements"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=
##title=Function: Teaser-Elements
##
# --// BO getTeaserElements //--

request = container.REQUEST
teaserElmnts = []
obs = context.breadcrumbs_obj_path(portalMaster=False)
obs.reverse()
this = context.getSelf()
for ob in obs:
  abort_penetrance = ob != this and ob.meta_type == 'ZMSLinkElement'
  if abort_penetrance:
    break
  temp = []
  subobs = ob.filteredChildNodes( request, ['ZMSCustom','ZMSTeaserContainer'])
  for subob in subobs:
    if subob.meta_id == 'ZMSTeaserContainer':
      temp.extend( subob.filteredChildNodes( request))
    elif subob.getType() == 'ZMSTeaserElement':
      temp.append( subob)
  for teaserElmnt in temp:
    penetrance = teaserElmnt.getObjProperty('attr_penetrance',request)
    if ( penetrance in [0,'this',''] and context == ob) or \
       ( penetrance in [1,'sub_nav'] and context.meta_id in ['ZMS','ZMSFolder']) or \
       ( penetrance in [2,'sub_all']):
      teaserElmnts.insert( 0, teaserElmnt)
  abort_penetrance = ob.getObjProperty('attr_zmsteasercontainer_abort_penetrance',request) not in ['',0]
  if abort_penetrance:
    break
teaserElmnts.reverse()
return teaserElmnts

# --// EO getTeaserElements //--
]]>
                  </item>
                  <item key="id"><![CDATA[getTeaserElements]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Function: Teaser-Elements]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[Script (Python)]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[## Script (Python) "pageelement_Teaser"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=here=None,request=None
##title=Template: Teaser
##
# --// BO pageelement_Teaser //--

request = container.REQUEST
RESPONSE =  request.RESPONSE

last_borderstyle = None
last_bgcolor_border = None
teaserElmnts = context.getTeaserElements()
if teaserElmnts:
  print '<div id="teaser">'
  for teaserElmnt in teaserElmnts:
    teaserCntnr = teaserElmnt.getParentNode()
    borderstyle = teaserCntnr.attr('attr_borderstyle')
    bgcolor_border = teaserCntnr.attr('attr_bgcolor_border')
    request.set('bgcolor_title',teaserCntnr.attr('attr_bgcolor_title'))
    request.set('bgcolor_text',teaserCntnr.attr('attr_bgcolor_text'))
    if last_borderstyle != borderstyle or \
       last_bgcolor_border != bgcolor_border or \
       borderstyle == 2:
      if last_borderstyle is not None and \
         last_bgcolor_border is not None:
        if last_borderstyle != 3:
          print '</div>'
      if borderstyle != 3:
        print '<div class="%s"'%teaserCntnr.meta_id
        if bgcolor_border:
          print ' style="background-color:%s;"'%teaserElmnt.get_colormap().get(bgcolor_border,'transparent')
        print '>'
    if teaserElmnt.meta_id in ['ZMSLinkElement','ZMSFile','ZMSTeaserElement']:
      name = 'pageelement_TeaserElement'
    else:
      name = 'bodyContentZMSCustom_%s'%teaserElmnt.meta_id
    method = getattr(teaserElmnt,name)
    method_result = method(teaserElmnt,request)
    try:
      method_result = unicode(method_result,'utf-8')
    except:
      pass
    print method_result
    last_borderstyle = borderstyle
    last_bgcolor_border = bgcolor_border
  if last_borderstyle is not None and \
     last_bgcolor_border is not None:
    if last_borderstyle != 3:
      print '</div>'
  print '</div>'

return unicode(printed).encode('utf-8')

# --// EO pageelement_Teaser //--
]]>
                  </item>
                  <item key="id"><![CDATA[pageelement_Teaser]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Template: Teaser]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[Script (Python)]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[<!-- ZMSTeaserContainer.renderShort -->

<tal:block tal:define="global 
		zmscontext options/zmscontext">
	<div class="form-small" tal:repeat="teaserElmnt python:zmscontext.getChildNodes(request)">
		<a tal:attributes="href python:'%s/manage_main?lang=%s'%(teaserElmnt.absolute_url(),request['lang'])">
			<img tal:attributes="src python:'%sinternal_link.gif'%zmscontext.MISC_ZMS; title python:zmscontext.getZMILangStr('CAPTION_EDIT')%teaserElmnt.display_type(request)" width="16" height="16" border="0" align="absmiddle"/>
		</a>
		<tal:block tal:define="global 
				url      python:zmscontext.getLinkUrl(teaserElmnt.attr('attr_url'));
				img_src  python:teaserElmnt.attr('attr_img_src')+'?';
				title    python:teaserElmnt.attr('title');
				abstract python:zmscontext.search_quote(teaserElmnt.attr('attr_abstract'))">
			<tal:block tal:condition="python:title">
				<a tal:condition="python:url" tal:attributes="href url" target="_blank" class="zmi" tal:content="title"><b>The title</b></a>
				<tal:block tal:condition="python:not url" tal:content="title">The title</tal:block>
			</tal:block>
			<tal:block tal:condition="python:not title">
				<tal:block tal:condition="python:img_src">
					<div><i>&laquo;<span tal:omit-tag="" tal:content="python:img_src[img_src.rfind('/')+1:img_src.find('?')]"></span>&raquo;</i></div>
				</tal:block>
			</tal:block>
			<div tal:content="structure abstract">The abstract</div>
		</tal:block>
	</div>
</tal:block>


<!-- /ZMSTeaserContainer.renderShort -->]]>
                  </item>
                  <item key="id"><![CDATA[renderShort]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[ZMI: Render short]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[zpt]]></item>
                  <item key="zpt"><![CDATA[<ZopePageTemplate at ZMSTeaserContainer.renderShort>]]></item>
                </dictionary>
              </item>
            </list>
          </item>
          <item key="access" type="dictionary">
            <dictionary>
              <item key="delete" type="list">
                <list>
                  <item><![CDATA[ZMSAdministrator]]></item>
                  <item><![CDATA[ZMSAuthor]]></item>
                  <item><![CDATA[ZMSEditor]]></item>
                </list>
              </item>
              <item key="delete_custom"></item>
              <item key="insert" type="list">
                <list>
                  <item><![CDATA[ZMSAdministrator]]></item>
                  <item><![CDATA[ZMSAuthor]]></item>
                  <item><![CDATA[ZMSEditor]]></item>
                </list>
              </item>
              <item key="insert_custom"><![CDATA[{$}]]></item>
            </dictionary>
          </item>
          <item key="enabled" type="int">1</item>
          <item key="id"><![CDATA[ZMSTeaserContainer]]></item>
          <item key="name"><![CDATA[ZMSTeaserContainer]]></item>
          <item key="package"><![CDATA[com.zms.foundation]]></item>
          <item key="revision"><![CDATA[1.2.3]]></item>
          <item key="type"><![CDATA[ZMSObject]]></item>
        </dictionary>
      </item>
    </dictionary>
  </item>
  <item type="dictionary">
    <dictionary>
      <item key="key"><![CDATA[ZMSTeaserElement]]></item>
      <item key="value" type="dictionary">
        <dictionary>
          <item key="__obj_attrs__" type="list">
            <list>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/gif" filename="zmsteaserelement_16x16.gif" type="file">47494638396110001000b30000040284c48e0cfcf88cfcfed5fcca54fcf173fcfaacfcfeedfce270fc02fcfcfe84fcee84fcfebdfcd664fcfe9cfcfefc21f90401000009002c000000001000100003045330c949eb0c38eb40c3f960787052309c27809e64123030c0c832dc0686a303bca23b378182073810158a2072d85bde168502404a8dde10588434abbd36b05f44b8d1726d020d72d95222acd9a537dc35af2722003b</data>
                  </item>
                  <item key="id"><![CDATA[icon]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom">
                    <data content_type="image/gif" filename="zmsteaserelement_disabled_16x16.gif" type="file">47494638396110001000b30000fc02fc8c8e8ccccecce4e6e4f4f2f4dcdadceceeecfcfafce4e2e4d4d6d4eceaecf4f6f4dcdedc0000ff0000ff0000ff21f90401000000002c000000001000100003045110c849eb0c38eb40c3f960787092179a200904c44178f0d2aa6cfb62eeb2d0c60d6384d745a130183284e2713850049c5084f3522820aa81ab1541b37ab5576e6713282430164b40a04a8fdde9363c1d01003b</data>
                  </item>
                  <item key="id"><![CDATA[icon_disabled]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Icon (Disabled)]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[resource]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[attr_penetrance]]></item>
                  <item key="keys" type="list">
                    <list>
                      <item><![CDATA[this]]></item>
                      <item><![CDATA[sub_nav]]></item>
                      <item><![CDATA[sub_all]]></item>
                    </list>
                  </item>
                  <item key="mandatory" type="int">1</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Penetrance]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[select]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="default"><![CDATA[2]]></item>
                  <item key="id"><![CDATA[displaytype]]></item>
                  <item key="mandatory" type="int">1</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Display-Type]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[int]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[attr_url]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">1</item>
                  <item key="name"><![CDATA[Url]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[url]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[attr_img]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">1</item>
                  <item key="name"><![CDATA[Image]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[image]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[title]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">1</item>
                  <item key="name"><![CDATA[Title]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[string]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="id"><![CDATA[text]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">1</item>
                  <item key="name"><![CDATA[Text]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[richtext]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[## Script (Python) "ZMSTeaserElement.attr_img_src"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=zmscontext
##title=py: Alias: Image
##
# --// BO attr_img_src //--

img = zmscontext.attr('attr_img')
if img:
    return img.getHref(zmscontext.REQUEST)
return ''

# --// EO attr_img_src //--
]]>
                  </item>
                  <item key="id"><![CDATA[attr_img_src]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Alias: Image]]></item>
                  <item key="py"><![CDATA[<PythonScript at ZMSTeaserElement.attr_img_src>]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[py]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[## Script (Python) "ZMSTeaserElement.attr_abstract"
##bind container=container
##bind context=context
##bind namespace=
##bind script=script
##bind subpath=traverse_subpath
##parameters=zmscontext
##title=py: Alias: Abstract
##
# --// BO attr_abstract //--

return zmscontext.attr('text')

# --// EO attr_abstract //--
]]>
                  </item>
                  <item key="id"><![CDATA[attr_abstract]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Alias: Abstract]]></item>
                  <item key="py"><![CDATA[<PythonScript at ZMSTeaserElement.attr_abstract>]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[py]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[<!-- pageelement_TeaserElement -->

	<span tal:omit-tag="" tal:define="global 
		bgcolor_title python:request.get('bgcolor_title');
		bgcolor_text  python:request.get('bgcolor_text');
		url           python:here.getLinkUrl(here.attr('attr_url'),request);
		img_src_attr  python:here.attr('attr_img_src');
		img_src       python:img_src_attr+'?';
		img_filename  python:img_src[img_src.rfind('/')+1:img_src.find('?')];
		title_url     python:here.attr('title');
		title_txt     python:title_url;
		abstract      python:here.attr('attr_abstract')">
		
		<span tal:omit-tag="" tal:define="global styles python:[]">
			<span tal:omit-tag="" tal:condition="bgcolor_title" tal:define="global styles python:styles+['background-color:'+here.get_colormap().get(bgcolor_title,'transparent')]">
			</span>
		</span>
		<div class="ZMSTeaserElement" tal:attributes="style python:''.join(styles)">
			
			<span tal:omit-tag="" tal:condition="python:len(title_url) > 4 and title_url.startswith('__') and title_url.endswith('__')">
				<span tal:omit-tag="" tal:define="global title_url python:title_url[2:-2]; title_txt python:''"></span>
			</span>
			
			<span tal:omit-tag="" tal:condition="python:title_txt or img_filename" tal:define="global 
					displaytype python:here.dctDisplaytype.get(str(here.attr('displaytype')),'left');
					img         python:'<img class=\042title\042 src=\042'+img_src_attr+'\042 alt=\042'+title_txt+'\042 border=\0420\042/>'">
					
				<span tal:omit-tag="" tal:condition="python:displaytype=='top'">
					<div class="graphic" tal:condition="python:img_filename">
						<a tal:condition="python:url" tal:attributes="href url; title title_url" tal:content="structure img">The image</a>
						<span tal:condition="python:not url" tal:omit-tag="" tal:content="structure img">The image</span>
					</div>
					<div class="title" tal:condition="python:title_txt">
						<a tal:condition="python:url" tal:attributes="href url; title title_url" tal:content="structure title_txt">The title</a>
						<span tal:condition="python:not url" tal:omit-tag="" tal:content="structure title_txt">The title</span>
					</div>
				</span>
				
				<span tal:omit-tag="" tal:condition="python:displaytype=='right'">
					<div class="graphic" tal:condition="python:img_filename">
						<a tal:condition="python:url" tal:attributes="href url; title title_url" tal:content="structure img">The image</a>
						<span tal:condition="python:not url" tal:omit-tag="" tal:content="structure img">The image</span>
					</div>
					<div class="title" tal:condition="python:title_txt">
						<a tal:condition="python:url" tal:attributes="href url; title title_url" tal:content="structure title_txt">The title</a>
						<span tal:condition="python:not url" tal:omit-tag="" tal:content="structure title_txt">The title</span>
					</div>
					<div class="clearfloating" style="clear:both">&nbsp;</div>
				</span>
				
				<span tal:omit-tag="" tal:condition="python:displaytype=='bottom'">
					<div class="title" tal:condition="python:title_txt">
						<a tal:condition="python:url" tal:attributes="href url; title title_url" tal:content="structure title_txt">The title</a>
						<span tal:condition="python:not url" tal:omit-tag="" tal:content="structure title_txt">The title</span>
					</div>
					<div class="graphic" tal:condition="python:img_filename">
						<a tal:condition="python:url" tal:attributes="href url; title title_url" tal:content="structure img">The image</a>
						<span tal:condition="python:not url" tal:omit-tag="" tal:content="structure img">The image</span>
					</div>
				</span>
				
				<span tal:omit-tag="" tal:condition="python:displaytype=='left'">
					<div class="graphic" tal:condition="python:img_filename">
						<a tal:condition="python:url" tal:attributes="href url; title title_url" tal:content="structure img">The image</a>
						<span tal:condition="python:not url" tal:omit-tag="" tal:content="structure img">The image</span>
					</div>
					<div class="title" tal:condition="python:title_txt">
						<a tal:condition="python:url" tal:attributes="href url; title title_url" tal:content="structure title_txt">The title</a>
						<span tal:condition="python:not url" tal:omit-tag="" tal:content="structure title_txt">The title</span>
					</div>
					<div class="clearfloating" style="clear:both">&nbsp;</div>
				</span>
				
				<span tal:omit-tag="" tal:define="global styles python:[]">
					<span tal:omit-tag="" tal:condition="bgcolor_text" tal:define="global styles python:styles+['background-color:'+here.get_colormap().get(bgcolor_text,'transparent')]">
					</span>
				</span>
				<div tal:condition="python:len(abstract)+len(url)>0" class="text" tal:attributes="style python:''.join(styles)">
					<span tal:omit-tag="" tal:content="structure abstract">The abstract</span>
					<span tal:omit-tag="" tal:condition="python:len(abstract)>0 and len(url)>0" tal:content="structure python:here.getLangStr('HREF_MORE',request['lang'])%(' href=\042%s\042 title=\042%s\042'%(url,title_url))">The url</span>
				</div>
				
			</span>
			
		</div>
	</span>

<!-- /pageelement_TeaserElement -->]]>
                  </item>
                  <item key="id"><![CDATA[pageelement_TeaserElement]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Template: Teaser-Element]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[Page Template]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[<!-- bodyContentZMSCustom_ZMSTeaserElement -->

<tal:block tal:define="global 
		zmscontext options/zmscontext;
		teaserCntnr     python:zmscontext.getParentNode();
		subclass        python:[teaserCntnr.meta_id];
		style           python:[];
		bgcolor_border  python:teaserCntnr.attr('attr_bgcolor_border');
		bgcolor_title   python:teaserCntnr.attr('attr_bgcolor_title');
		bgcolor_text    python:teaserCntnr.attr('attr_bgcolor_text')">
	<div tal:condition="python:request.get('URL','').find('/manage')>0" id="teaser">
		<tal:block tal:condition="python:bgcolor_border">
			<tal:block tal:define="global style python:style+['border: 1px solid '+zmscontext.get_colormap().get(bgcolor_border,'black')]"></tal:block>
		</tal:block>
		<div tal:attributes="class python:' '.join(subclass); style python:' '.join(style)" tal:content="structure python:zmscontext.pageelement_TeaserElement(zmscontext,request)">
			The teaser-element
		</div>
	</div>
	<div tal:condition="python:not (request.get('URL','').find('/manage')>0)" tal:attributes="class python:' '.join(subclass); style python:' '.join(style)" tal:content="structure python:zmscontext.pageelement_TeaserElement(zmscontext,request)">
		The teaser-element
	</div>
</tal:block>

<!-- /bodyContentZMSCustom_ZMSTeaserElement -->]]>
                  </item>
                  <item key="id"><![CDATA[bodyContentZMSCustom_ZMSTeaserElement]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Template: ZMSTeaserElement]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[zpt]]></item>
                  <item key="zpt"><![CDATA[<ZopePageTemplate at ZMSTeaserElement.bodyContentZMSCustom_ZMSTeaserElement>]]></item>
                </dictionary>
              </item>
              <item type="dictionary">
                <dictionary>
                  <item key="custom"><![CDATA[<!-- ZMSTeaserElement.standard_html -->

<tal:block tal:define="global 
		zmscontext options/zmscontext;
		teaserCntnr     python:zmscontext.getParentNode();
		subclass        python:[teaserCntnr.meta_id];
		style           python:[];
		bgcolor_border  python:teaserCntnr.attr('attr_bgcolor_border');
		bgcolor_title   python:teaserCntnr.attr('attr_bgcolor_title');
		bgcolor_text    python:teaserCntnr.attr('attr_bgcolor_text')">
	<div tal:condition="python:request.get('URL','').find('/manage')>0" id="teaser">
		<tal:block tal:condition="python:bgcolor_border">
			<tal:block tal:define="global style python:style+['border: 1px solid '+zmscontext.get_colormap().get(bgcolor_border,'black')]"></tal:block>
		</tal:block>
		<div tal:attributes="class python:' '.join(subclass); style python:' '.join(style)" tal:content="structure python:zmscontext.pageelement_TeaserElement(zmscontext,request)">
			The teaser-element
		</div>
	</div>
	<div tal:condition="python:not (request.get('URL','').find('/manage')>0)" tal:attributes="class python:' '.join(subclass); style python:' '.join(style)" tal:content="structure python:zmscontext.pageelement_TeaserElement(zmscontext,request)">
		The teaser-element
	</div>
</tal:block>

<!-- /ZMSTeaserElement.standard_html -->]]>
                  </item>
                  <item key="id"><![CDATA[standard_html]]></item>
                  <item key="mandatory" type="int">0</item>
                  <item key="multilang" type="int">0</item>
                  <item key="name"><![CDATA[Template: ZMSTeaserElement]]></item>
                  <item key="repetitive" type="int">0</item>
                  <item key="type"><![CDATA[zpt]]></item>
                  <item key="zpt"><![CDATA[<ZopePageTemplate at ZMSTeaserElement.standard_html>]]></item>
                </dictionary>
              </item>
            </list>
          </item>
          <item key="access" type="dictionary">
            <dictionary>
              <item key="delete" type="list">
                <list>
                  <item><![CDATA[ZMSAdministrator]]></item>
                  <item><![CDATA[ZMSAuthor]]></item>
                  <item><![CDATA[ZMSEditor]]></item>
                </list>
              </item>
              <item key="delete_custom"></item>
              <item key="insert" type="list">
                <list>
                  <item><![CDATA[ZMSAdministrator]]></item>
                  <item><![CDATA[ZMSAuthor]]></item>
                  <item><![CDATA[ZMSEditor]]></item>
                </list>
              </item>
              <item key="insert_custom"><![CDATA[{$}]]></item>
            </dictionary>
          </item>
          <item key="enabled" type="int">1</item>
          <item key="id"><![CDATA[ZMSTeaserElement]]></item>
          <item key="name"><![CDATA[ZMSTeaserElement]]></item>
          <item key="package"><![CDATA[com.zms.foundation]]></item>
          <item key="revision"><![CDATA[1.3.0]]></item>
          <item key="type"><![CDATA[ZMSTeaserElement]]></item>
        </dictionary>
      </item>
    </dictionary>
  </item>
  <item type="dictionary">
    <dictionary>
      <item key="key"><![CDATA[com.zms.foundation]]></item>
      <item key="value" type="dictionary">
        <dictionary>
          <item key="__obj_attrs__" type="list">
            <list>
            </list>
          </item>
          <item key="access" type="dictionary">
            <dictionary>
              <item key="delete" type="list">
                <list>
                </list>
              </item>
              <item key="delete_custom"></item>
              <item key="insert" type="list">
                <list>
                </list>
              </item>
              <item key="insert_custom"></item>
            </dictionary>
          </item>
          <item key="enabled" type="int">0</item>
          <item key="id"><![CDATA[com.zms.foundation]]></item>
          <item key="name"><![CDATA[com.zms.foundation]]></item>
          <item key="package"></item>
          <item key="revision"><![CDATA[1.3.0]]></item>
          <item key="type"><![CDATA[ZMSPackage]]></item>
        </dictionary>
      </item>
    </dictionary>
  </item>
  <item type="dictionary">
    <dictionary>
      <item key="key"><![CDATA[com.zms2go.foundation]]></item>
      <item key="value" type="dictionary">
        <dictionary>
          <item key="__obj_attrs__" type="list">
            <list>
            </list>
          </item>
          <item key="enabled" type="int">1</item>
          <item key="id"><![CDATA[com.zms2go.foundation]]></item>
          <item key="name"><![CDATA[com.zms2go.foundation]]></item>
          <item key="package"></item>
          <item key="revision"><![CDATA[0.0.0]]></item>
          <item key="type"><![CDATA[ZMSPackage]]></item>
        </dictionary>
      </item>
    </dictionary>
  </item>
</list>